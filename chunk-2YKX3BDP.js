import{c as H}from"./chunk-4OR6Y7OY.js";import{a as C}from"./chunk-F7VIIAWX.js";import{A as E,Ea as k,Fa as P,M as R,S as D,T as w,U as S,f as T,r as x,t as _,v as q}from"./chunk-FCZ3UZ6C.js";import"./chunk-EQDQRRRY.js";var v="repulse",A=0,I=6,L=3,B=2,j=0,z=0,G=1,O=.5,V=class extends C{constructor(a,n){super(n),this._clickRepulse=()=>{let t=this.container,s=t.actualOptions.interactivity.modes.repulse;if(!s)return;let e=t.repulse??{particles:[]};if(e.finish||(e.count||(e.count=0),e.count++,e.count===t.particles.count&&(e.finish=!0)),e.clicking){let i=t.retina.repulseModeDistance;if(!i||i<A)return;let r=Math.pow(i/I,L),u=t.interactivity.mouse.clickPosition;if(u===void 0)return;let o=new k(u.x,u.y,r),c=t.particles.quadTree.query(o,l=>this.isEnabled(l));for(let l of c){let{dx:p,dy:f,distance:y}=E(u,l.position),d=y**B,h=s.speed,M=-r*h/d;if(d<=r){e.particles.push(l);let g=x.create(p,f);g.length=M,l.velocity.setTo(g)}}}else if(e.clicking===!1){for(let i of e.particles)i.velocity.setTo(i.initialVelocity);e.particles=[]}},this._hoverRepulse=()=>{let t=this.container,s=t.interactivity.mouse.position,e=t.retina.repulseModeDistance;!e||e<j||!s||this._processRepulse(s,e,new k(s.x,s.y,e))},this._processRepulse=(t,s,e,i)=>{let r=this.container,u=r.particles.quadTree.query(e,h=>this.isEnabled(h)),o=r.actualOptions.interactivity.modes.repulse;if(!o)return;let{easing:c,speed:l,factor:p,maxSpeed:f}=o,y=_(c),d=(i?.speed??l)*p;for(let h of u){let{dx:M,dy:g,distance:m}=E(h.position,t),b=q(y(G-m/s)*d,z,f),F=x.create(m?M/m*b:d,m?g/m*b:d);h.position.addTo(F)}},this._singleSelectorRepulse=(t,s)=>{let e=this.container,i=e.actualOptions.interactivity.modes.repulse;if(!i)return;let r=document.querySelectorAll(t);r.length&&r.forEach(u=>{let o=u,c=e.retina.pixelRatio,l={x:(o.offsetLeft+o.offsetWidth*O)*c,y:(o.offsetTop+o.offsetHeight*O)*c},p=o.offsetWidth*O*c,f=s.type==="circle"?new k(l.x,l.y,p):new P(o.offsetLeft*c,o.offsetTop*c,o.offsetWidth*c,o.offsetHeight*c),y=i.divs,d=S(y,o);this._processRepulse(l,p,f,d)})},this._engine=a,n.repulse||(n.repulse={particles:[]}),this.handleClickMode=t=>{let s=this.container.actualOptions,e=s.interactivity.modes.repulse;if(!e||t!==v)return;n.repulse||(n.repulse={particles:[]});let i=n.repulse;i.clicking=!0,i.count=0;for(let r of n.repulse.particles)this.isEnabled(r)&&r.velocity.setTo(r.initialVelocity);i.particles=[],i.finish=!1,setTimeout(()=>{n.destroyed||(i.clicking=!1)},e.duration*1e3)}}clear(){}init(){let a=this.container,n=a.actualOptions.interactivity.modes.repulse;n&&(a.retina.repulseModeDistance=n.distance*a.retina.pixelRatio)}interact(){let a=this.container,n=a.actualOptions,t=a.interactivity.status===T,s=n.interactivity.events,e=s.onHover,i=e.enable,r=e.mode,u=s.onClick,o=u.enable,c=u.mode,l=s.onDiv;t&&i&&R(v,r)?this._hoverRepulse():o&&R(v,c)?this._clickRepulse():w(v,l,(p,f)=>this._singleSelectorRepulse(p,f))}isEnabled(a){let n=this.container,t=n.actualOptions,s=n.interactivity.mouse,e=(a?.interactivity??t.interactivity).events,i=e.onDiv,r=e.onHover,u=e.onClick,o=D(v,i);if(!(o||r.enable&&s.position||u.enable&&s.clickPosition))return!1;let c=r.mode,l=u.mode;return R(v,c)||R(v,l)||o}loadModeOptions(a,...n){a.repulse||(a.repulse=new H);for(let t of n)a.repulse.load(t?.repulse)}reset(){}};export{V as Repulser};
