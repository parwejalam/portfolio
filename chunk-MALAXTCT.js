import"./chunk-HKUNN5OK.js";import{A as c,Ca as V,Fa as O,Ha as B,V as S,aa as w,ba as R,o as a,x as m,y as r}from"./chunk-6FL7R2MJ.js";import"./chunk-EQDQRRRY.js";var y=class{load(o){o&&(o.bottom!==void 0&&(this.bottom=c(o.bottom)),o.left!==void 0&&(this.left=c(o.left)),o.right!==void 0&&(this.right=c(o.right)),o.top!==void 0&&(this.top=c(o.top)))}};var g=class extends O{constructor(){super(),this.value=3}};var b=class extends O{constructor(){super(),this.value={min:4,max:9}}};var v=class{constructor(){this.count=1,this.factor=new g,this.rate=new b,this.sizeOffset=!0}load(o){o&&(o.color!==void 0&&(this.color=V.create(this.color,o.color)),o.count!==void 0&&(this.count=o.count),this.factor.load(o.factor),this.rate.load(o.rate),this.particles=w(o.particles,t=>S({},t)),o.sizeOffset!==void 0&&(this.sizeOffset=o.sizeOffset),o.colorOffset&&(this.colorOffset=this.colorOffset??{},o.colorOffset.h!==void 0&&(this.colorOffset.h=o.colorOffset.h),o.colorOffset.s!==void 0&&(this.colorOffset.s=o.colorOffset.s),o.colorOffset.l!==void 0&&(this.colorOffset.l=o.colorOffset.l)))}};var x=class{constructor(){this.bounds=new y,this.mode="none",this.split=new v}load(o){o&&(o.mode&&(this.mode=o.mode),o.bounds&&this.bounds.load(o.bounds),this.split.load(o.split))}};var z=0,E=.5,F=0,D=1,M=500,T=0;function W(l,o,t,e){let f=t.options.destroy;if(!f)return;let i=f.split,s=B(l,o,t.options),u=r(i.factor.value),d=t.getFillColor();i.color?s.color.load(i.color):i.colorOffset&&d?s.color.load({value:{hsl:{h:d.h+r(i.colorOffset.h??z),s:d.s+r(i.colorOffset.s??z),l:d.l+r(i.colorOffset.l??z)}}}):s.color.load({value:{hsl:t.getFillColor()}}),s.move.load({center:{x:t.position.x,y:t.position.y,mode:"precise"}}),a(s.size.value)?s.size.value/=u:(s.size.value.min/=u,s.size.value.max/=u),s.load(e);let p=i.sizeOffset?c(-t.size.value,t.size.value):z,h={x:t.position.x+m(p),y:t.position.y+m(p)};return o.particles.addParticle(h,s,t.group,n=>n.size.value<E?!1:(n.velocity.length=m(c(t.velocity.length,n.velocity.length)),n.splitCount=(t.splitCount??F)+D,n.unbreakable=!0,setTimeout(()=>{n.unbreakable=!1},M),!0))}function P(l,o,t){let e=t.options.destroy;if(!e)return;let f=e.split;if(f.count>=T&&(t.splitCount===void 0||t.splitCount++>f.count))return;let i=r(f.rate.value),s=R(f.particles);for(let u=0;u<i;u++)W(l,o,t,s)}var k=class{constructor(o,t){this.container=t,this.engine=o}init(o){let t=this.container,e=o.options,f=e.destroy;if(!f)return;o.splitCount=0;let i=f.bounds;o.destroyBounds||(o.destroyBounds={});let{bottom:s,left:u,right:d,top:p}=i,{destroyBounds:h}=o,n=t.canvas.size;s&&(h.bottom=r(s)*n.height/100),u&&(h.left=r(u)*n.width/100),d&&(h.right=r(d)*n.width/100),p&&(h.top=r(p)*n.height/100)}isEnabled(o){return!o.destroyed}loadOptions(o,...t){o.destroy||(o.destroy=new x);for(let e of t)o.destroy.load(e?.destroy)}particleDestroyed(o,t){if(t)return;let e=o.options.destroy;e&&e.mode==="split"&&P(this.engine,this.container,o)}update(o){if(!this.isEnabled(o))return;let t=o.getPosition(),e=o.destroyBounds;e&&(e.bottom!==void 0&&t.y>=e.bottom||e.left!==void 0&&t.x<=e.left||e.right!==void 0&&t.x>=e.right||e.top!==void 0&&t.y<=e.top)&&o.destroy()}};export{k as DestroyUpdater};
